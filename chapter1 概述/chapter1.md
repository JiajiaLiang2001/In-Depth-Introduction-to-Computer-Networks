- [第 1 章 概述](#第-1-章-概述)
  - [1.1 信息时代的计算机网络](#11-信息时代的计算机网络)
  - [1.2 因特网](#12-因特网)
    - [网络、互联网与因特网的区别与关系](#网络互联网与因特网的区别与关系)
    - [因特网简介](#因特网简介)
  - [1.3 电路交换、分组交换和报文交换](#13-电路交换分组交换和报文交换)
    - [电路交换、分组交换和报文交换](#电路交换分组交换和报文交换)
      - [电路交换](#电路交换)
      - [分组交换](#分组交换)
      - [报文交换](#报文交换)
    - [三种交换方式的对比](#三种交换方式的对比)
    - [1.4 计算机网络的定义和分类](#14-计算机网络的定义和分类)
      - [计算机网络的定义](#计算机网络的定义)
      - [计算机网络的分类](#计算机网络的分类)
    - [1.5 计算机的性能指标](#15-计算机的性能指标)
      - [速率](#速率)
      - [带宽](#带宽)
      - [吞吐量](#吞吐量)
      - [时延](#时延)
      - [时延带宽积](#时延带宽积)
      - [往返时间](#往返时间)
      - [利用率](#利用率)
      - [丢包率](#丢包率)
  - [1.6 计算机网络体系结构](#16-计算机网络体系结构)
    - [常用的三种计算机网络系统结构](#常用的三种计算机网络系统结构)
    - [计算机网络体系结构分层的必要性](#计算机网络体系结构分层的必要性)
    - [计算机网络体系结构分层思想举例](#计算机网络体系结构分层思想举例)
    - [计算机网络体系结构中的专用术语](#计算机网络体系结构中的专用术语)

# 第 1 章 概述

## 1.1 信息时代的计算机网络

## 1.2 因特网

### 网络、互联网与因特网的区别与关系

- 若干节点和链路互连形成**网络**

<div align=center>
  <img src="img\1_2_1.png" height="50%" width="50%">
</div>


- 若干网络通过路由器互连形成**互联网**

<div align=center>
  <img src="img\1_2_2.png" height="50%" width="50%">
  <img src="img\1_2_3.png" height="50%" width="50%">
</div>


- **因特网**：当今世界上最大的互联网

<div align=center>
  <img src="img\1_2_4.png" height="25%" width="25%">
  <img src="img\1_2_5.png" height="50%" width="50%">
</div>


区别概念：

|          |   internet   |   Internet   |
| :------: | :----------: | :----------: |
| 名词属性 |   通用名词   |   专用名词   |
|   称呼   |    互联网    |    因特网    |
|   协议   | 任意通信协议 | TCP/IP协议族 |

### 因特网简介

- *发展阶段*

<div align=center>
  <img src="img\1_2_6.png">
</div>


- ***因特网服务提供者(lnternet Service Provider，ISP)***

<div align=center>
  <img src="img\1_2_7.png" height="50%" width="50%">
</div>


- *因特网已发展成为基于ISP的多层次结构的互连网络*

<div align=center>
  <img src="img\1_2_8.png" height="50%" width="50%">
</div>


- *因特网的标准化工作*

**RFC （Request For Comments）请求评论**：任何人都可以从因特网上免费下载RFC文档，并随时对某个RFC文档发表意见和建议。

<div align=center>
  <img src="img\1_2_9.png" height="50%" width="50%">
</div>


2011年10月取消草案标准阶段

<div align=center>
  <img src="img\1_2_10.png" height="50%" width="50%">
</div>


- *因特网的管理机构*

<div align=center>
  <img src="img\1_2_11.png" height="50%" width="50%">
</div>


- *因特网的组成*

<div align=center>
  <img src="img\1_2_12.png" height="50%" width="50%">
</div>


## 1.3 电路交换、分组交换和报文交换

### 电路交换、分组交换和报文交换

#### 电路交换

1. 建立连接：分配通信资源；
2. 通话：一直占用通信资源；
3. 释放连接：归还通信资源。

<div align=center>
  <img src="img\1_3_1.png" height="50%" width="50%">
</div>


$\color{red}{不适用于计算机之间的通信！}$：计算机之间的数据传送是**突发式**的，电路交换传输效率一般都会很低，真正用来传送数据的时间往往不到 10% 甚至 1%。

#### 分组交换

一对主机基于分组交换网的通信过程：

> 在实际因特网中：
>
> 1. 往往有大量主机在同时通信。
>
> 2. 在一台主机中也存在与网络通信的多个进程与其他主机不同的进程通信。

| 过程 |                                                              |        图解        |
| :--: | :----------------------------------------------------------- | :----------------: |
| $0$  | 主机 $H1$ 即将发送原始报文到主机 $H3$                        | ![](img\1_3_2.png) |
| $1$  | 主机 $H1$ 将原始报文划分成若干较小的等长数据段，添加必要控制信息组成的首部，构造出**分组** | ![](img\1_3_3.png) |
| $2$  | 分组经过各交换节点的**存储转发**，到达主机 $H3$              | ![](img\1_3_4.png) |
| $3$  | 主机 $H3$ 去掉首部，将各数据段组合还原成原始报文             | ![](img\1_3_5.png) |

具体存储转发过程：

<div align=center>
  <img src="img\1_3_6.png" height="50%" width="50%">
</div>


- 发送方：
  - 构造分组
  - 发送分组
- 交换节点
  - 缓存分组
  - 转发分组
- 接收方
  - 接收分组
  - 还原报文

#### 报文交换

- 分组交换的前身。

- $\color{green}{报文被整个地发送}$，而不是拆分成若干个分组进行发送。
- $\color{green}{报文整体接收完成后}$才能查找转发表，将整个报文转发到下一个节点。

- 报文交换比分组交换带来的$\color{green}{转发时延要长很多}$，需要交换节点具有的$\color{green}{缓存空间大很多}$。

### 三种交换方式的对比

<div align=center>
  <img src="img\1_3_7.png">
</div>


各自的优势对比

- 电路交换：连续传送大量的数据，并且数据传送时间远大于建立连接的时间。
- 报文交换和分组交换：传送计算机的突发数据【不需要建立连接（即预先分配通信资源)】。

### 1.4 计算机网络的定义和分类

#### 计算机网络的定义

**计算机网络早期的一个简单定义**：计算机网络是一个$\color{green}{互连}$，$\color{green}{自治}$的$\color{green}{计算机集合}$。

- 互连：有线链路或无线链路；
- 自治：主机之间独立运行；
- 计算机集合：至少需要两台以上的计算机。

**现阶段计算机网络的一个较好的定义**：计算机网络主要是由一些$\color{green}{通用的、可编程的硬件}$互连而成的，而这些硬件并非专门用来实现某一特定目的（例如，传送数据或视频信号）。这些可编程的硬件能够用来传送多种不同类型的数据，并能支持广泛的和日益增长的$\color{green}{应用}$。

- 可编程硬件：不限于计算机，而是包括了智能手机、具有网络功能的传感器以及智能家电等智能硬件（包含中央处理单元 $CPU$ ）
- 各类应用：计算机网络并非只用来传送数据，而是能够基于数据传送进而实现各种各样的应用，包括今后可能出现的各种应用。

#### 计算机网络的分类

| 分类标准 |                                                            |                    |
| -------- | ---------------------------------------------------------- | ------------------ |
| 交换方式 | 电路交换、分组交换、报文交换                               | ![](img\1_4_1.png) |
| 使用者   | 公有网（因特网）、专用网（军队、铁路、电力、银行）         | ![](img\1_4_2.png) |
| 传输介质 | 有线网络（双绞线网络、光纤网络等）、无线网络（WiFi）       | ![](img\1_4_3.png) |
| 覆盖范围 | 广域网（WAN），城域网（MAN）、局域网（LAN）、个域网（PAN） | ![](img\1_4_4.png) |
| 拓扑结构 | 总线型                                                     | ![](img\1_4_5.png) |
|          | 星型                                                       | ![](img\1_4_6.png) |
|          | 环型                                                       | ![](img\1_4_7.png) |
|          | 网状型                                                     | ![](img\1_4_8.png) |

### 1.5 计算机的性能指标

#### 速率

**比特（bit，b）**：计算机中数据量的基本单位。

> 一比特对应二进制数字中的一个 $1$ 或 $0$

其他数据量常用单位：

- 字节（$byte$，$B$）
- 千字节（$KB$）
- 兆字节（$MB$）
- 吉字节（$GB$）
- 太字节（$TB$）

换算关系（数据量单位中的K、M、G、T的数值分别为$2^{10}$，$2^{20}$，$2^{30}$，$2^{40}$。）：

| 数据量单位 | 换算关系                                                     |
| ---------- | ------------------------------------------------------------ |
| $b$        |                                                              |
| $B$        | $\mathrm{MB}=8 \mathrm{~b}$                                  |
| $KB$       | $\mathrm{KB}=\mathrm{K} \cdot \mathrm{B}=2^{10} \mathrm{~B}$ |
| $MB$       | $\mathrm{MB}=\mathrm{K} \cdot \mathrm{KB}=2^{20} \mathrm{~B}$ |
| $GB$       | $\mathrm{GB}=\mathrm{K} \cdot \mathrm{MB}=2^{30} \mathrm{~B}$ |
| $TB$       | $\mathrm{TB}=\mathrm{K} \cdot \mathrm{GB}=2^{40} \mathrm{~B}$ |

**速率/数据率/比特率**：数据的传送速率（每秒传送多少个比特）

基本单位：

- 比特/秒（$b/s$，$bit/s$，$bps$）

常用单位：

- 千比特/秒（$kb/s$，$kbps$）
- 兆比特/秒（$Mb/s$，$Mbps$）
- 吉比特/秒（$Gb/s$，$Gbps$）
- 太比特/秒（$Tb/s$，$Tbps$）

换算关系（速率单位中的K、M、G、T的数值分别为$10^{3}$，$10^{6}$，$10^{9}$，$10^{12}$。）：

| 速率单位 | 换算关系                                                     |
| -------- | ------------------------------------------------------------ |
| $b/s$    |                                                              |
| $kb/s$   | $\mathrm{kb} / \mathrm{s}=10^3 \mathrm{~b} / \mathrm{s}$     |
| $Mb/s$   | $\mathrm{Mb} / \mathrm{s}=\mathrm{k} \cdot \mathrm{kb} / \mathrm{s}=10^6 \mathrm{~b} / \mathrm{s}$ |
| $Gb/s$   | $\mathrm{Gb} / \mathrm{s}=\mathrm{k} \cdot \mathrm{Mb} / \mathrm{s}=10^9 \mathrm{~b} / \mathrm{s}$ |
| $Tb/s$   | $\mathrm{Tb} / \mathrm{s}=\mathrm{k} \cdot \mathrm{Gb} / \mathrm{s}=10^{12} \mathrm{~b} / \mathrm{s}$ |

【练习】有一个待发送的数据块，大小为 $100MB$ ，网卡的发送速率为 $100Mbps$ ，则网卡发送完该数据块需要多长时间?
$$
\frac{100 M B}{100 M b / s}=\frac{M B}{M b / s}=\frac{2^{20} B}{10^6 b / s}=\frac{2^{20} \times 8 b}{10^6 b / s}=8.388608 s
$$
$可以估算的时候直接约分：$
$$
\approx \frac{B}{b / s} =\frac{8 b}{b / s} =8 s
$$

#### 带宽

**带宽**：

- 模拟信号系统：某个信号所包含的各种不同频率成分所占据的频率范围。
  - 基本单位：$Hz$
  - 常用单位：$kHz$，$MHz$，$GHz$
- 计算机网络系统：用来表示网络的通信线路所能传送数据的能力，即在单位时间内从网络中的某一点到另一点所能通过的最高数据率。
  - 基本单位：$b/s$
  - 常用单位：$kb/s$，$Mb/s$，$Gb/s$，$Tb/s$

<div align=center>
  <img src="img\1_5_1.png" height="50%" width="50%">
</div>


$$
\text { 数据传送速率 }=\min \{\text { 主机接口速率，线路带宽，交换机或路由器的接口速率 \} }
$$



> 木桶效应

#### 吞吐量

**吞吐量**：单位时间内通过某个网络或接口的实际数据量。

> 吞吐量受网络带宽的限制。

<div align=center>
  <img src="img\1_5_2.png" height="50%" width="50%">
</div>


$$
\text { 吞吐量 }=20 \mathrm{Mb} / \mathrm{s}+600 \mathrm{~kb} / \mathrm{s}+1 \mathrm{Mb} / \mathrm{s}=21.6 \mathrm{Mb} / \mathrm{s}
$$

#### 时延

**时延/延迟/迟延**：数据（一个或多个分组，甚至是一个比特构成）从网络的一端传送到另一端所耗费的时间。

时延构成：

- **发送时延**：$\frac{\text { 分组长度 }(b)}{\text { 发送速率 }(b / s)}$
- **传播时延**：$\frac{\text { 信道长度 }(b)}{\text { 信号传播速率 }(b / s)}$
- **排队时延**：取决与网络通信量和路由器性能，无法计算
- **处理时延**：无法计算

<div align=center>
  <img src="img\1_5_7.png">
</div>


考虑两台主机+一台路由器的情况：

<div align=center>
  <img src="img\1_5_3.png" height="50%" width="50%">
</div>


| 过程 | 文字解释                                                     |   时延   | 图解               |
| :--: | :----------------------------------------------------------- | :------: | ------------------ |
| $0$  | 主机 $\longrightarrow$ 传输线路                              | 发送时延 | ![](img\1_5_4.png) |
| $1$  | 传输线路 $\longrightarrow$ 路由器                            | 传播时延 | ![](img\1_5_5.png) |
| $2$  | 分组在路由器排队缓存等待转发                                 | 排队时延 | ![](img\1_5_6.png) |
| $3$  | 路由器：检查分组首部是否误码、提取分组首部中的目的地址为分组查找相应的转发接口、修改分组首部的部分内容等 | 处理时延 | ![](img\1_5_6.png) |
| $4$  | 路由器 $\longrightarrow$ 传输线路                            | 发送时延 | 同$1$，逆过程      |
| $5$  | 传输线路 $\longrightarrow$ 主机                              | 传播时延 | 同$0$，逆过程      |

- 主机$A$给主机$B$发送单个分组的情况：也就是上述情况

<div align=center>
  <img src="img\1_5_8.png" height="50%" width="50%">
</div>


- 主机$A$给主机$B$发送两个分组的情况（不考虑排队时延和处理时延）：

<div align=center>
  <img src="img\1_5_9.png" height="50%" width="50%">
</div>


- 通过两端路由器相连，主机$A$给主机$B$发送四个分组的情况（不考虑排队时延和处理时延）：

<div align=center>
  <img src="img\1_5_10.png" height="50%" width="50%">
</div>


【练习】在下图所示的采用“存储-转发”方式的分组交换网中，所有链路的数据传输速率$100Mbps$，分组大小为$1000B$，其中分组头大小为$20B$。若主机$H1$向主机$H2$发送一个大小为$980 000B$的文件，则在不考虑分组拆装时间和传播延迟的情况下，从$H1$发送开始到$H2$接收完为止，需要的时间至少是多少？

<div align=center>
  <img src="img\1_5_11.png" height="50%" width="50%">
</div>


$最短路径：$

<div align=center>
  <img src="img\1_5_12.png" height="50%" width="50%">
</div>


$需要的最小时长 = 所有分组的发送时延 +1 个分组的发送时延 \times 2$
$$
=\frac{1000 B}{100 M b / s} \times \frac{980000 B}{1000 B-20 B}+\frac{1000 B}{100 M b / s} \times 2=80.16 \mathrm{~ms}
$$
【练习】分别计算数据块长度为$100MB$和$1B$，信道带宽为$1Mb/s$，传送距离为$1000KM$，传输介质为光纤情况下的发送时延和传播时延。

$情况一：$
$$
\begin{aligned}
\text { 发送时延 } &=\frac{\text { 分组长度 }(b)}{\text { 发送速率 }(b / \mathrm{s})} \\
&=\frac{100 \times 2^{20} \times 8(b)}{10^6(b / s)}=838.8608(\mathrm{~s}) \\
\text { 传播时延 } &=\frac{\text { 信道长度 }(\mathrm{m})}{\text { 信号传播速率 }(\mathrm{m} / \mathrm{s})} \\
&=\frac{1000 \times 10^3(\mathrm{~m})}{2 \times 10^8(\mathrm{~m} / \mathrm{s})}=0.005(\mathrm{~s})
\end{aligned}
$$
$情况二：$
$$
\begin{aligned}
\text { 发送时延 } &=\frac{\text { 分组长度 }(b)}{\text { 发送速率 }(b / \mathrm{s})} \\
&=\frac{1 \times 8(\mathrm{~b})}{10^6(\mathrm{~b} / \mathrm{s})}=8 \times 10^{-6}(\mathrm{~s}) \\
\text { 传播时延 } &=\frac{\text { 信道长度 }(\mathrm{m})}{} \\
&=\frac{1000 \overline{\overline{1}} \text { 号传播速率 }(\mathrm{m} / \mathrm{s})}{2 \times 10^8(\mathrm{~m} / \mathrm{s})}=0.005(\mathrm{~s})
\end{aligned}
$$

#### 时延带宽积

**时延带宽积**：传播时延和带宽的乘积。

> 链路的时延带宽积 == 以比特为单位的链路长度

#### 往返时间

**往返时间（Round-Trip Time，RTT）**：从发送端发送数据分组开始，到发送端收到接收端发来的相应确认分组为止，总共耗费的时间。

#### 利用率

**链路利用率**：某条链路有百分之几的时间是被利用。

**网络利用率**：网络中所有链路利用率的加权平均。

- $D_0$：网络空闲时的时延
- $D$：网络当前的时延
- $U$：网络利用率

在理想的假定条件下：
$$
D=\frac{D_0}{1-U}
$$

<div align=center>
  <img src="img\1_5_13.png" height="50%" width="50%">
</div>


> 一些大型ISP往往会控制信道利用率不超过50%。如果超过了就要进行扩容，增大线路的带宽。

#### 丢包率

**丢包率**：在一定时间范围内，传输过程中丢失的分组数量与总分组数量的比率。

分为网络丢包率、接口丢包率、节点丢包率、链路丢包率、路径丢包率。

分组丢失的两种情况：

1. 分组在传输过程中出现误码，被传输路径中的节点交换机（例如路由器）或目的主机检测出误码而丢弃。
2. 节点交换机根据丢弃策略主动丢弃分组。

$\color{red}{丢包率可以反映网络的拥塞情况}$

| 拥塞情况 | 丢包率            |
| -------- | ----------------- |
| 无拥塞   | $0$               |
| 轻度拥塞 | $1 \% \sim 4 \%$  |
| 严重拥塞 | $5 \% \sim 15 \%$ |

## 1.6 计算机网络体系结构

### 常用的三种计算机网络系统结构

<div align=center>
  <img src="img\1_6_1.png" height="50%" width="50%">
</div>


$\color{red}{OSI标准失败的原因}$：

1. 专家没有实际经验完成标准时没有商业驱动力；
2. 协议实现过分复杂运行效率很低；
3. 标准的制定周期太长产品无法及时进入市场；
4. 层次划分不太合理有些功能在多个层次中重复出现。

$TCP/IP$ 体系结构

<div align=center>
  <img src="img\1_6_2.png">
</div>


<div align=center>
  <img src="img\1_6_3.png">
</div>


> $TCP/IP$ 体系结构：为了将不同的网络接口进行互连，其网络接口层并没有规定什么具体内容。
>
> 对于学习计算机网络体系就会缺少部分内容！

因此产生了**原理参考模型**：

<div align=center>
  <img src="img\1_6_4.png">
</div>


### 计算机网络体系结构分层的必要性  

- $\color{pink}{应用层}$：解决通过应用进程的交互来实现特定网络应用的问题。
  - 通过应用进程间的交互完成特定的网络应用
  - 会话管理和数据表示
- $\color{blue}{运输层}$：解决进程之间基于网络的通信问题。
  - 如何解决进程之间基于网络的通信（$\color{red}{进程的标识，端口号}$）
  - 如何处理数据传输差错（$\color{red}{差错处理：可靠传输和不可靠传输}$）
- $\color{orange}{网络层}$：解决数据包在多个网络之间传输和路由的问题。
  - 如何标识网络和网络中各主机（$\color{red}{网络和主机共同编址，IP地址}$）
  - 路由器转发分组（$\color{red}{路由选择协议，路由器和转发表}$）
- $\color{green}{数据链路层}$：解决数据包在一个网络或一段链路上传输的问题。
  - 如何标识网络中各主机（$\color{red}{主机编址，MAC地址}$）
  - 如何从比特流中区分出地址和数据（$\color{red}{数据封装格式}$）
  - 如何协调网络中各主机争用总线（$\color{red}{媒体接入控制}$）——总线型网络
  - 以太网交换机的实现（$\color{red}{自学习和转发帧}$）——有线网络
  - 如何检测数据是否误码（$\color{red}{差错检测}$）——无限网络和有线网络
  - 如何处理数据传输差错（$\color{red}{差错处理：可靠传输和不可靠传输}$）——无限网络和有线网络
  - 接收方控制发送方注入网络的数据量（$\color{red}{流量控制}$）——无限网络和有线网络
- $\color{grey}{物理层}$：解决使用何种信号来表示比特0和1的问题。
  - 采用什么$\color{red}{传输媒体}$
  - 采用什么$\color{red}{物理接口}$
  - 采用什么$\color{red}{信号}$表示比特0和1

### 计算机网络体系结构分层思想举例

【练习】假设$OSI$参考模型的应用层欲发送$400B$的数据（无拆分)，除物理层和应用层之外，其他各层在封装$PDU$时均引入$20B$的额外开销，则应用层数据传输效率约为（）。
A.80%
B.83%
C.87%
D.91%

<div align=center>
  <img src="img\1_6_5.png" height="50%" width="50%">
</div>


$$
\frac{400 B}{400 B+20 B+20 B+20 B+20 B+20 B}=80 \%
$$

### 计算机网络体系结构中的专用术语

**实体**：任何可发送或接受信息的硬件或软件进程。

**对等实体**：通信双方相同层次中的实体。

<div align=center>
  <img src="img\1_6_6.png" height="50%" width="50%">
</div>


**协议**：控制两个对等实体在“水平方向”进行”逻辑通信”的规则的集合。

三要素：

- **语法**：定义所交换信息的格式。
- **语义**：定义通信双方索要完成的操作。
- **同步**：定义通信双方的时序关系。

**服务**：在协议的控制下，两个对等实体在水平方向的逻辑通信使得本层能够向上一层提供服务。

> 要实现本层协议，还需要使用下一层所提供的服务。

<div align=center>
  <img src="img\1_6_7.png" height="50%" width="50%">
</div>


> 协议是“水平”的，而服务是“垂直”的。
>
> 下层的协议对上层的实体是“透明”的：实体看得见下层提供的服务，不知道实现该服务的具体协议。

**服务访问点$SAP$**：在同一系统中相邻两层的实体交换信息的逻辑接口，被用于区分不同的服务类型。

**服务原语$SP$**：上层要使用下层所提供的服务，必须通过与下层交换一些命令。

**协议数据单元$PDU$**：对等层次之间传送的数据包。

**服务数据单元$SDU$**：不同层次之间交换的数据包。

<div align=center>
  <img src="img\1_6_9.png" height="50%" width="50%">
</div>